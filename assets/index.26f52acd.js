(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function g(i){return L(new P(i))}function L(i){function e(n,s){return typeof n[s]!="function"&&typeof n[s]!="object"?n[s]:(s.startsWith("$")&&(s=s.substring(1)),typeof n[s]=="function"?function(...l){return n[s].apply(n,l)}.bind(this):new Proxy(n[s],{set:(l,r,f)=>(t.__handleEffect(t.__isReactive(f),()=>{l[r]=t.__handleFunction(f)}),!0),get:(l,r)=>e(l,r)}))}const t=new Proxy(i,{get:(n,s)=>{if(s in n)return n[s];if(s in n.__element)return e(n.__element,s)},set:(n,s,o)=>s in n?(n[s]=o,!0):(s.startsWith("$")&&(s=s.substring(1)),s=="style"?n.$set_style(o):s in n.__element&&n.$property(s,o),!0)});return t}class P{constructor(e){if(typeof e=="string")this.__element=document.createElement(e);else if(e instanceof HTMLElement)this.__element=e;else throw new Error("Invalid element name");this.__events=[],this.__children=[],this.__states=new Set,this.__unmounted_events=[],this.__mounted_events=[],this.__parent=null}__update(){for(const e of this.__events)e()}$click(){return this.__element.click(),this}$find(e){var t=[];this.__element.matches(e)&&t.push(L(this));for(const n of this.__children)t=t.concat(n.$find(e));return t}$update(){for(const e of this.__events)e();for(const e of this.__children)e.$update()}__parseInput(e){if(e&&e.key=="e0b8fc2b-fc7e-4786-bc05-b85187a8d065"){for(const t of e.elements)t&&t.__subscribe&&(this.__states.add(t),t.__subscribe(this));return e.expression}return e}__observeParent(){setTimeout(()=>{for(const t of this.__mounted_events)t()},0),new MutationObserver(t=>{for(const n of t){if(n.type==="childList"&&n.removedNodes.length){for(const s of n.removedNodes)if(s===this.__element){this.__unsubscribe();for(const o of this.__unmounted_events)o()}}if(n.type==="childList"&&n.addedNodes.length){for(const s of n.addedNodes)if(s===this.__element){this.__subscribe();for(const o of this.__mounted_events)o()}}}}).observe(this.__element.parentElement,{childList:!0})}__subscribe(){if(this.__states)for(const e of this.__states)e.__subscribe(this)}__unsubscribe(){for(const e of this.__children)e.__unsubscribe();if(this.__states)for(const e of this.__states)e.__unsubscribe(this)}__handleFunction(e){return typeof e=="function"?e():e}__handleEffect(e,t){e?(t(),this.__events.push(t)):t()}__isReactive(...e){for(const t of e)if(typeof t=="function")return!0;return!1}$if(e){return e=this.__parseInput(e),this.__handleEffect(this.__isReactive(e),()=>{const t=this.__handleFunction(e);this.$style("display",t?"":"none")}),this}$class(e,t=!0){e=this.__parseInput(e),t=this.__parseInput(t);var n=null;return this.__handleEffect(this.__isReactive(e,t),()=>{const s=this.__handleFunction(e);if(s)if(typeof s=="object")for(const o in s)s[o]?this.__element.classList.add(o):this.__element.classList.remove(o);else this.__handleFunction(t)?(this.__isReactive(e)&&(n&&this.__element.classList.remove(...n.split(" ").filter(o=>o.length>0)),n=s),this.__element.classList.add(...s.split(" ").filter(o=>o.length>0))):(this.__element.classList.remove(...s.split(" ").filter(o=>o.length>0)),n=null)}),this}get parentElement(){return this.__parent}$parent(e){return this.__parent=e,e.__element!==void 0?(e.__element.appendChild(this.__element),e.__children.push(this)):e.appendChild(this.__element),this.__observeParent(),this}$parentBefore(e){return this.__parent=e,e.__element!==void 0?e.__element.firstChild?e.__element.insertBefore(this.__element,e.__element.firstChild):e.__element.appendChild(this.__element):e.firstChild?e.insertBefore(this.__element,e.firstChild):e.appendChild(this.__element),this.__observeParent(),this}$on(e,t){return e==="mounted"?(this.__onMounted(t),this):e==="unmounted"?(this.__onUnmounted(t),this):e==="update"?(this.__onUpdate(t),this):(this.__element.addEventListener(e,t),this)}__onUpdate(e){return this.__events.push(e),this}__onMounted(e){this.__mounted_events.push(e)}__onUnmounted(e){this.__unmounted_events.push(e)}$property(e,t){return e=this.__parseInput(e),t=this.__parseInput(t),this.__handleEffect(this.__isReactive(e,t),()=>{this.__element[this.__handleFunction(e)]=this.__handleFunction(t)}),this}$style(e,t=null){return t?(this.__style(e,t),this):(e=this.__parseInput(e),this.__handleEffect(this.__isReactive(e),()=>{var n=this.__handleFunction(e);if(typeof n=="object")for(const s in n)this.__element.style[s]=n[s];else{const s=n.split(";").filter(o=>o.length>0);this.__element.style={};for(const o of s){const[l,r]=o.split(":");this.__element.style.setProperty(l,this.__handleFunction(r))}}}),this)}__style(e,t){return e=this.__parseInput(e),t=this.__parseInput(t),this.__handleEffect(this.__isReactive(e,t),()=>{this.__element.style[this.__handleFunction(e)]=this.__handleFunction(t)}),this}$get_computed_style(e){return window.getComputedStyle(this.__element).getPropertyValue(e)}$child(e){e=this.__parseInput(e);var t;this.__isReactive(e)?t=g("span").$parent(this):t=this;var n=null;return this.__handleEffect(this.__isReactive(e),()=>{var s=this.__handleFunction(e);n&&n();const o=r=>r==null?()=>{}:r.__element!==void 0?(r.$parent(t),()=>r.$remove()):(r instanceof HTMLElement||(r=document.createTextNode(r)),t.__element.appendChild(r),()=>r.remove());if(Array.isArray(s)){var l=[];for(const r of s)l.push(o(r));n=()=>{for(const r of l)r()}}else n=o(s)}),this}$remove(){return this.__parent=null,this.__element.remove(),this}$model([e,t]){return this.$property("value",e),this.$on("input",n=>t(n.target.value)),this}}function k(i){return new Proxy({},{get:function(e,t){if(!!i){if(t.startsWith("$"))return F(i[t.substr(1)]);if(i[t])return C(i[t])}}})}function C(i){return i&&i.key=="e0b8fc2b-fc7e-4786-bc05-b85187a8d065"?i.expression():i}function F(i){return i&&i.key=="e0b8fc2b-fc7e-4786-bc05-b85187a8d065"?i.expression:()=>i}const p=(i,e,...t)=>{var n,s=!1;if(typeof i=="function"){if(n=i(k(e),...t),n===void 0)return t;s=!0}else n=g(i);const o={ref:r=>{r.__ref_object=n},style:r=>{n.$style(r)},class:r=>{n.$class(r)},parent:r=>{n.$parent(r)},if:r=>{n.$if(r)},model:([r,f])=>{n.$model([r,f])}},l={on:(r,f)=>{n.$on(r,f)}};if(e)for(const[r,f]of Object.entries(e)){const c=r.split(":");c.length==2?l[c[0]]&&l[c[0]](c[1],f):o[r]?o[r](f):s||n.$property(r,f)}if(t&&!s)for(const r of t)n.$child(r);return n};function I({width:i,height:e}){const t=p("canvas",null);t.width=i,t.height=e;const n=t.getContext("2d");function s({x:c,y:h,r:_,border:{color:d,width:u},color:a}){n.beginPath(),n.arc(c,h,_,0,2*Math.PI),n.fillStyle=a,n.fill(),n.strokeStyle=d,n.lineWidth=u,n.stroke()}function o({x1:c,y1:h,x2:_,y2:d,color:u,width:a}){n.beginPath(),n.moveTo(c,h),n.lineTo(_,d),n.strokeStyle=u,n.lineWidth=a,n.stroke()}function l(){n.clearRect(0,0,i,e)}function r(){var c=t.toDataURL("image/png"),h=document.createElement("a");h.download="image.png",h.href=c,h.click()}function f(){var c=[],h=t.captureStream(25);const _=new MediaRecorder(h,{mimeType:"video/webm;codecs=opus,vp8"});_.start(100),_.ondataavailable=function(u){c.push(u.data)};function d(){return _.stop(),new Promise((u,a)=>{_.onstop=function(S){var R=new Blob(c,{type:"video/webm"}),x=URL.createObjectURL(R);u(x)}})}return{stop:d}}return{canvas:t,useRecord:f,clear:l,save:r,circle:s,line:o}}const{canvas:v,useRecord:N,clear:T,save:U,circle:b,line:w}=I({width:800,height:600}),y=p("button",null,"Upload"),m=p("video",{controls:!0,width:"800",height:"600"}),H=p("div",{class:"column"},{key:"e0b8fc2b-fc7e-4786-bc05-b85187a8d065",expression:()=>y,elements:[typeof y<"u"?y:void 0]},p("div",{class:"rpw"},{key:"e0b8fc2b-fc7e-4786-bc05-b85187a8d065",expression:()=>v,elements:[typeof v<"u"?v:void 0]},{key:"e0b8fc2b-fc7e-4786-bc05-b85187a8d065",expression:()=>m,elements:[typeof m<"u"?m:void 0]})),E=p("input",{type:"file"});y.$on("click",function(){E.click()});E.$on("change",function(){const i=this.files[0],e=new FileReader;e.addEventListener("load",function(){const t=JSON.parse(e.result);O(t)}),e.readAsText(i)});const $=["red","green","blue","yellow","orange","purple","pink","brown","black","white"];function M(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!=e[t])return!1;return!0}async function O(i){let e=i.colorHistory[0].map(()=>0);var t=[...e];i.colorHistory.push(i.colorHistory[i.colorHistory.length-1]),i.selected.push(-1);const{stop:n}=N();for(const s in i.colorHistory){const o=i.selected[s];t=[...e],await l(),e=i.colorHistory[s],M(t,e)||await l();async function l(){T();for(const _ of i.connections){var{x:r,y:f}=i.nodes[_.from],{x:c,y:h}=i.nodes[_.to];_.from==o||_.to==o?w({x1:r,y1:f,x2:c,y2:h,color:"cyan",width:5}):w({x1:r,y1:f,x2:c,y2:h,color:"white",width:2})}for(const _ in i.nodes){const{x:d,y:u}=i.nodes[_];_==o?b({x:d,y:u,r:14,border:{color:"cyan",width:5},color:"white"}):t[_]==e[_]?b({x:d,y:u,r:14,border:{color:"white",width:2},color:$[e[_]]}):b({x:d,y:u,r:20,border:{color:"white",width:2},color:$[e[_]]})}await new Promise(_=>setTimeout(_,500))}}await new Promise(s=>setTimeout(s,1e3)),n().then(s=>{m.src=s})}H.$parent(document.body);
